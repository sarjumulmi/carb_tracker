<%= form_for @recipe do |f| %>

  <%= render partial: "layouts/form_errors", locals: { form_errors: @recipe } %>

  <%= f.label :name, "Recipe Name" %>
  <%= f.text_field :name %>

  <%= f.label :public, "Public or Private" %>
  <%= f.select :public, options_for_select(
    [["Public", true],["Private", false]], @recipe.public) %>

  <%= f.label :serving_size %>
  <%= f.number_field :serving_size, min: 0.00, step: 0.25 %>

  <%= f.fields_for :foods do |food| %>
    <% if food.object.invalid? %>
      <div class="nested-fields">
        <%= render "food_fields", f: food %>
      </div>
    <% end %>
  <% end %>

  <div class="links add-foods">
    <%= link_to_add_association f, :foods, partial: "food_fields" do %>
      <button>Add Food</button>
    <% end %>
  </div>

  <%= f.fields_for :ingredients do |ingredient| %>
    <% if ingredient.object.food.valid? %>
      <%= render "ingredient_fields", f: ingredient %>
    <% end %>
  <% end %>

  <div class="links add-ingredient">
    <%= link_to_add_association f, :ingredients do %>
      <button>Add Ingredient</button>
    <% end %>
  </div>

  <fieldset>
    <%= f.label :search, "Search for New Foods" %><br>
    <%= f.text_area :search, rows: 5, cols: 25 %>

    <p>
    Powered by <%= link_to "Nutritionix API",
      "http://www.nutritionix.com/api",
      target: "_blank" %>
    </p>

    <p>
    Please each food on a separate line.  Example: <br>
    "1 gala apple"<br>
    "1/4 cup walnuts"
    </p>

    <%= f.submit "Search" %>
  </fieldset>

  <%= f.submit %>
<% end %>

